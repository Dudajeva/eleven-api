<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.adzc.elevenapi.mapper.ChatMessageMapper">

    <select id="countUnread" resultType="int">
        select count(*) from chat_message
        where conversation_id=#{cid}
          and id &gt; #{cursor}
          and sender_id &lt;&gt; #{uid}
    </select>

    <select id="pageDesc" resultType="org.adzc.elevenapi.domain.ChatMessage">
        select * from chat_message
        where conversation_id=#{cid}
        <if test="cursor != null">and id &lt; #{cursor}</if>
        order by id desc
        limit #{size}
    </select>

</mapper>
