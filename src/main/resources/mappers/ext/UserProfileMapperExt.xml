<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.adzc.elevenapi.mapper.UserProfileMapper">


    <update id="updateAvatar">
        UPDATE user_profile SET avatar_url = #{avatarUrl}
        WHERE user_id = #{userId}
    </update>

    <!-- 更新隐藏开关 -->
    <update id="updateHidePhotos">
        UPDATE user_profile
        SET hide_photos = #{hide},
            updated_at = NOW()
        WHERE user_id = #{uid}
    </update>

    <select id="selectByIds"
            parameterType="list"
            resultMap="BaseResultMap">
        <choose>
            <when test="list != null and list.size() > 0">
                SELECT
                user_id,
                nickname,
                avatar_url,
                gender,
                age,
                city,
                member_level,
                created_at,
                updated_at
                FROM user_profile
                WHERE user_id IN
                <foreach collection="list" item="uid" open="(" separator="," close=")">
                    #{uid}
                </foreach>
            </when>
            <otherwise>
                SELECT
                user_id,
                nickname,
                avatar_url,
                gender,
                age,
                city,
                member_level,
                created_at,
                updated_at
                FROM user_profile
                WHERE 1 = 0
            </otherwise>
        </choose>
    </select>
</mapper>
